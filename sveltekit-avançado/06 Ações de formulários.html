<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://unpkg.com/highlightjs-svelte/dist/svelte.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js"></script>
  <script defer>hljs.configure({ languages: ["svelte"] }); hljs.highlightAll(); hljs.initLineNumbersOnLoad();</script>

  <!-- https://github.com/arronhunt/highlightjs-copy -->
  <link rel="stylesheet" href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css" />
  <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
  <script defer>hljs.addPlugin(new CopyButtonPlugin());</script>

  <!-- https://github.com/TRSasasusu/highlightjs-highlight-lines.js -->
  <!-- <script src="https://cdn.jsdelivr.net/gh/TRSasasusu/highlightjs-highlight-lines.js@1.2.0/highlightjs-highlight-lines.min.js"></script>
  <script defer>hljs.highlightLinesAll([[], [], [], [], [], [],
    [{ start: 1, end: 1, color: 'lightblue' }, { start: 7, end: 8, color: 'lightgreen' }, { start: 9, end: 13, color: 'lightblue' }],
    [{ start: 1, end: 3, color: 'lightblue' }, { start: 14, end: 19, color: 'lightblue' }],
    [{ start: 13, end: 21, color: 'lightblue' }, { start: 24, end: 27, color: 'lightblue' }],
    [{ start: 8, end: 9, color: 'lightgreen' }, { start: 14, end: 19, color: 'lightblue' }],
    [{ start: 1, end: 1, color: 'lightgreen' }, { start: 5, end: 6, color: 'lightgreen' }, { start: 7, end: 18, color: 'lightblue' }],
    ]);
  </script> -->

  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body,{delimiters:[{left: '$$', right: '$$', display: true},{left: '$', right: '$', display: false}]});"></script> -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/pedrosiqueira/custom-style/custom.min.css">
  <script src="https://cdn.jsdelivr.net/gh/pedrosiqueira/custom-style/custom.min.js"></script>
</head>

<h1>A√ß√µes de Formul√°rio</h1>
<h2>Tipos de requisi√ß√µes HTTP</h2>
<p>Existem x tipos de requisi√ß√µes HTTP que podem ser enviadas a um servidor. S√£o os chamados verbos HTTP, ou m√©todos HTTP... [continue]</p>
<p>At√© o momento s√≥ temos trabalhado com requisi√ß√µes GET. Nesse cap√≠tulo, vamos trabalhar com requisi√ß√µes POST.</p>
<img src="." alt="uma imagem de um cliente enviando dois tipos de cartas ao servidor, uma carta GET, que s√≥ possui o envelope, com o endere√ßo do destinat√°rio como uma url; e uma carta POST, que possui uma mensagem dentro do envelope, al√©m do endere√ßo.">

<h2>Enviando uma carta GET</h2>
<p>No cap√≠tulo <a target="_blank" href="./03 Carregando dados do servidor.html">Carregando dados do servidor</a>, vimos como enviar dados do servidor para o navegador. Muitas vezes, precisamos fazer o inverso ‚Äî enviar dados do navegador para o servidor. Para isso, utilizamos o elemento <code>&lt;form&gt;</code>, o principal recurso da web para esse tipo de comunica√ß√£o. Por padr√£o, o formul√°rio envia dados via requisi√ß√£o HTTP <code>GET</code>, que n√£o possui corpo e deixa as informa√ß√µes vis√≠veis na URL ‚Äî o que traz <a target="_blank" href="../sveltekit/0D Protocolo HTTP.html#desvantagens">v√°rias desvantagens</a>.</p>

<p>Crie o arquivo <code ctc>src/routes/06/get/+page.svelte</code>:</p>
<pre><code class="language-svelte">&lt;script&gt;
  let { data } = $props();
&lt;/script&gt;

&lt;form&gt;
  &lt;input name="email" type="email" placeholder="E-mail de usu√°rio" /&gt;
  &lt;input name="senha" type="password" placeholder="Senha" /&gt;
  &lt;button&gt;Entrar&lt;/button&gt;
&lt;/form&gt;
{#if data.status == 400}
  &lt;p&gt;E-mail e senha s√£o obrigat√≥rios&lt;/p&gt;
{:else if data.status == 401}
  &lt;p&gt;Usu√°rio ou senha inv√°lidos&lt;/p&gt;
{:else if data.status == 200}
  &lt;p&gt;Login efetuado com sucesso!&lt;/p&gt;
  &lt;p&gt;Bem-vindo, {data.email}!&lt;/p&gt;
{/if}</code></pre>

<p>Crie o arquivo <code ctc>src/routes/06/get/+page.server.js</code>:</p>
<pre><code class="language-javascript">export async function load({ url }) {
    const email = url.searchParams.get('email');
    const senha = url.searchParams.get('senha');
    if (!email || !senha) return { status: 400 };
    if (senha !== '1234') return { status: 401 };
    return { status: 200, email };
}</code></pre>

<p><strong>Explica√ß√£o:</strong> Ao submeter o formul√°rio, os dados aparecem na URL. O servidor l√™ esses par√¢metros em <code>load</code>, retorna um status, e a p√°gina exibe mensagens diferentes conforme o valor de <code>data.status</code>. Note que, neste exemplo, a senha fica vis√≠vel na URL!</p>

<h2 id="Default-actions">A√ß√£o padr√£o (default)</h2>

<p>Um arquivo <code>+page.server.js</code> pode exportar um objeto <code>actions</code>, cujas fun√ß√µes tratam requisi√ß√µes <code>POST</code> enviadas por formul√°rios.</p>

<p>Crie o arquivo <code ctc>src/routes/06/post/+page.svelte</code>:</p>
<pre><code class="language-svelte">&lt;form method="POST"&gt;
  &lt;input name="email" type="email" placeholder="E-mail de usu√°rio" /&gt;
  &lt;input name="senha" type="password" placeholder="Senha" /&gt;
  &lt;button&gt;Entrar&lt;/button&gt;
&lt;/form&gt;</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Ao submeter, o formul√°rio usa o m√©todo <code>POST</code> e envia os dados para a URL atual (j√° que <code>action</code> n√£o foi especificado).</li>
  <li>Isso aciona a a√ß√£o <code>default</code> no arquivo <code>+page.server.js</code> correspondente.</li>
</ul>

<p>Crie o arquivo <code ctc>src/routes/06/post/+page.server.js</code>:</p>
<pre><code class="language-javascript">export const actions = {
  default: async (event) =&gt; {
    console.log(event);
    console.log(await event.request.formData());
  }
};</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Linha 2: A fun√ß√£o <code>default</code> ser√° executada sempre que a rota <code>/06/post</code> receber uma requisi√ß√£o <code>POST</code>.</li>
  <li>Linha 2: O par√¢metro <code>event</code> √© um objeto <a target="_blank" href="https://svelte.dev/docs/kit/@sveltejs-kit#RequestEvent">RequestEvent</a>, que cont√©m informa√ß√µes detalhadas da requisi√ß√£o.</li>
  <li>Como vimos no <a target="_blank" href="./03 Carregando dados do servidor.html#serverloadevent">cap√≠tulo anterior</a>, a fun√ß√£o <code>load</code> recebe um objeto <a target="_blank" href="https://svelte.dev/docs/kit/@sveltejs-kit#ServerLoadEvent">ServerLoadEvent</a>, que herda os m√©todos de <code>RequestEvent</code>. Por isso, voc√™ j√° deve estar familiarizado com propriedades como <code>params</code>, <code>url</code> e <code>fetch</code>, dispon√≠veis tanto em a√ß√µes de formul√°rio quanto na fun√ß√£o <code>load</code>.</li>
  <li>Linha 3: Imprimimos o objeto <code>event</code> no terminal do servidor, para fins de teste.</li>
  <li>Linha 4: Para acessar os dados enviados pelo formul√°rio, utilizamos o m√©todo ass√≠ncrono <code>formData()</code> do objeto <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/Request"><code>request</code></a>, que √© uma propriedade de <code>event</code>.</li>
</ul>

<div class="info">
  <p><strong>Observa√ß√£o:</strong> A√ß√µes de formul√°rio s√≥ respondem a requisi√ß√µes <code>POST</code>, pois requisi√ß√µes <code>GET</code> n√£o devem causar efeitos colaterais no servidor.</p>
</div>

<p>Tamb√©m podemos enviar dados para outra rota especificando <code>action</code> no formul√°rio.</p>

<p>Crie o arquivo <code ctc>src/routes/06/form/+page.svelte</code>:</p>
<pre><code class="language-svelte">&lt;form method="POST" action="/06/post"&gt;
  &lt;input type="number" placeholder="Digite um n√∫mero" /&gt;
  &lt;input name="umtexto" placeholder="Digite um texto" /&gt;
  &lt;input name="umadata" type="date" /&gt;
  &lt;button&gt;Entrar&lt;/button&gt;
&lt;/form&gt;</code></pre>

<p><strong>Explica√ß√£o:</strong>
  Ao informar <code>action="/06/post"</code>, este formul√°rio envia os dados para a a√ß√£o padr√£o de <code>/06/post</code>, onde ser√£o processados.</p>

<div class="info">
  <p><strong>Observa√ß√£o:</strong> Cada campo deve ter o atributo <code>name</code> para que seu valor seja inclu√≠do na requisi√ß√£o. No exemplo acima, o valor do campo num√©rico sem <code>name</code> n√£o ser√° enviado.</p>
</div>

<p>√ìtimo! Agora temos um meio eficiente de trocar dados entre p√°ginas!</p>

<h2>Retornando dados</h2>

<p>Ap√≥s processar a requisi√ß√£o, a a√ß√£o pode retornar dados que ficam dispon√≠veis na propriedade <code>form</code> da p√°gina correspondente, e tamb√©m em <code>page.form</code> em todo o aplicativo, at√© a pr√≥xima atualiza√ß√£o de p√°gina.</p>

<p>Modifique <code ctc>src/routes/06/post/+page.server.js</code>:</p>
<pre><code class="language-javascript">export const actions = {
  default: async ({ request }) =&gt; {
    const data = await request.formData();
    const email = data.get('email');
    const senha = data.get('senha');
    if (!email || !senha) return { status: 400 };
    if (senha !== '1234') return { status: 401 };
    return { status: 200, email };
  }
};</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Linha 2: Desestruturamos o objeto <code>event</code>, pois s√≥ precisamos de sua propriedade <code>request</code>.</li>
  <li>Linha 3-5: Usamos <code>request.formData()</code> para ler os campos <code>email</code> e <code>senha</code>.</li>
  <li>Linhas 6-8: Se algum campo estiver vazio, retornamos <code>{ status: 400 }</code>. Se a senha estiver incorreta, retornamos <code>{ status: 401 }</code>. Caso contr√°rio, retornamos <code>{ status: 200, email }</code>.</li>
</ul>
<p>Assim como os dados retornados por <code>load</code> <a target="_blank" href="./03 Carregando dados do servidor.html#load-return">ficam dispon√≠veis</a> na propriedade <code>data</code>, os dados retornados por uma a√ß√£o de formul√°rio ficam dispon√≠veis na propriedade <code>form</code>.</p>

<p>Agora, modifique <code ctc>src/routes/06/post/+page.svelte</code> para exibir esses dados:</p>
<pre><code class="language-svelte">&lt;script&gt;
  let { form } = $props();
&lt;/script&gt;

&lt;form method="POST"&gt;
  &lt;input name="email" type="email" placeholder="E-mail de usu√°rio" /&gt;
  &lt;input name="senha" type="password" placeholder="Senha" /&gt;
  &lt;button&gt;Entrar&lt;/button&gt;
&lt;/form&gt;
{#if !form}
  &lt;p&gt;Preencha e submeta o formul√°rio.&lt;/p&gt;
{:else if form.status == 400}
  &lt;p&gt;E-mail e senha s√£o obrigat√≥rios&lt;/p&gt;
{:else if form.status == 401}
  &lt;p&gt;Usu√°rio ou senha inv√°lidos&lt;/p&gt;
{:else if form.status == 200}
  &lt;p&gt;Login efetuado com sucesso!&lt;/p&gt;
  &lt;p&gt;Bem-vindo, {form.email}!&lt;/p&gt;
{/if}</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Linha 2: A propriedade <code>form</code> cont√©m os dados retornados pela a√ß√£o de formul√°rio.</li>
  <li>Linha 10: Diferentemente de <code>load</code>, que sempre √© executada ao acessar a rota, a√ß√µes de formul√°rio s√≥ s√£o executadas ap√≥s uma requisi√ß√£o <code>POST</code>. Portanto, <code>form</code> pode n√£o existir se n√£o houve submiss√£o, e precisamos fazer essa verifica√ß√£o antes de acessar qualquer de suas propriedades.</li>
  <li>Se <code>form</code> existir, verificamos <code>form.status</code> e exibimos a mensagem apropriada.</li>
</ul>

<h2>Redirecionamentos</h2>

<p>Para navegar o usu√°rio ap√≥s a a√ß√£o, usamos a fun√ß√£o <code>redirect(status, url)</code> de <code>@sveltejs/kit</code>, que lan√ßa uma exce√ß√£o interrompendo a execu√ß√£o da a√ß√£o e respondendo com o c√≥digo de redirecionamento.</p>

<p>Modifique <code ctc>src/routes/06/post/+page.server.js</code>:</p>
<pre><code class="language-javascript">import { redirect } from '@sveltejs/kit';

export const actions = {
  default: async ({ request }) =&gt; {
    const data = await request.formData();
    const email = data.get('email');
    const senha = data.get('senha');
    if (!email || !senha) return { status: 400 };
    if (senha !== '1234') return { status: 401 };
    redirect(303, '/06/profile');
  }
};</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Linha 1: Importamos <code>redirect</code> de <code>@sveltejs/kit</code>.</li>
  <li id="profile">Linha 10: Se o login for bem-sucedido, redirecionamos o usu√°rio para a rota <code>/06/profile</code>, que ainda n√£o foi criada, com o c√≥digo HTTP 303.</li>
</ul>

<div class="info">
  <p><strong>Observa√ß√£o:</strong> Toda resposta a uma requisi√ß√£o HTTP possui um c√≥digo de status. C√≥digos 300‚Äì399 indicam redirecionamentos; 400‚Äì499, erros do cliente; 500‚Äì599, erros do servidor. Consulte a <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status">documenta√ß√£o do MDN</a> para detalhes.</p>
</div>

<div class="info">
  <p><strong>Importante:</strong> <code>redirect()</code> lan√ßa uma exce√ß√£o, encerrando imediatamente a execu√ß√£o da a√ß√£o. N√£o coloque-o dentro de um bloco <code>try/catch</code>, pois disparar√° o <code>catch</code>.</p>
</div>

<div class="info">
  <p><strong>Observa√ß√£o:</strong> Redirecionamentos tamb√©m podem ser usados em <a target="_blank" href="https://svelte.dev/docs/kit/load#Redirects"><code>load</code></a>.</p>
</div>

<h2>Valida√ß√£o de erros</h2>

<p>Se a requisi√ß√£o n√£o puder ser processada devido a dados inv√°lidos, √© poss√≠vel retornar mensagens de erro junto com os valores inseridos anteriormente. Isso permite que o usu√°rio corrija os dados e tente novamente. A fun√ß√£o <code>fail(status, dados)</code> de <code>@sveltejs/kit</code> retorna um c√≥digo HTTP (tipicamente na faixa dos 400) e um objeto com dados como detalhes do erro, e valores dos campos. O status fica dispon√≠vel em <code>page.status</code> e os dados em <code>form</code>.</p>

<p>Modifique <code ctc>src/routes/06/post/+page.server.js</code>:</p>
<pre><code class="language-javascript">import { fail, redirect } from '@sveltejs/kit';

export const actions = {
  default: async ({ request }) =&gt; {
    const data = await request.formData();
    const email = data.get('email');
    const senha = data.get('senha');

    if (!email || !senha) return fail(400, { error: 'Email e senha s√£o obrigat√≥rios.', email });

    if (!email.includes('@')) return fail(400, { error: 'Email inv√°lido.', email });

    if (senha.length &lt; 4) return fail(400, { error: 'A senha deve ter pelo menos 4 caracteres.', email });

    if (email == "email@inexistente") return fail(400, { error: 'Email ou senha inv√°lidos.', email });

    redirect(303, '/06/profile');
  }
}</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Linhas 9‚Äì15: Validamos os dados. Se estiverem inv√°lidos, usamos <code>fail</code> para retornar a mensagem de erro e manter os dados do formul√°rio.</li>
  <li>Linha 11: A valida√ß√£o de email √© simplificada. Em sistemas reais, utilize bibliotecas espec√≠ficas e robustas para isso.</li>
  <li>Linha 15: Apenas para simular a situa√ß√£o de um email inexistente.</li>
</ul>

<p>Modifique <code ctc>src/routes/06/post/+page.svelte</code>:</p>
<pre><code class="language-svelte">&lt;script&gt;
  let { form } = $props();
&lt;/script&gt;

&lt;form method="POST"&gt;
  &lt;input name="email" type="email" placeholder="E-mail de usu√°rio" value={form?.email || ''} required /&gt;
  &lt;input name="senha" type="password" placeholder="Senha" required /&gt;
  &lt;button&gt;Entrar&lt;/button&gt;
&lt;/form&gt;

{#if form?.error}
  &lt;p style="color: red"&gt;{form?.error}&lt;/p&gt;
{/if}</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Linha 6: O campo e-mail mant√©m seu valor em caso de erro, para que o usu√°rio n√£o precise digit√°-lo novamente.</li>
  <li>Linha 7: Por seguran√ßa, a senha n√£o √© preservada ap√≥s um erro.</li>
  <li>Linha 12: Se houver erro, mostramos a mensagem apropriada.</li>
  <li>A valida√ß√£o no navegador (como <code>type="email"</code> e <code>required</code>) ajuda a evitar erros, mas a valida√ß√£o no servidor √© indispens√°vel, pois o c√≥digo do cliente pode ser alterado pelo usu√°rio. Para testar, inspecione o campo de e-mail, remova o atributo <code>type="email"</code> e tente enviar um endere√ßo de e-mail inv√°lido.</li>
</ul>

<div class="info">
  <p><strong>Observa√ß√£o:</strong> Na linha 6, <code>?.</code> √© um <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining">operador de encadeamento opcional</a>, que tenta acessar a propriedade <code>email</code> do objeto <code>form</code>. Se o objeto for indefinido ou nulo, a express√£o entra em curto-circuito e √© avaliada como <code>undefined</code> em vez de gerar um erro.</p>
  <p>O equivalente de <code>form?.email || ''</code> usando <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_operator">operador tern√°rio</a> seria <code>form? form.email : ''</code>, que significa: obtenha o <code>email</code> de <code>form</code>, caso exista, sen√£o, obtenha uma string vazia.</p>
</div>

<h2>GET vs POST</h2>
<p>Para invocar uma a√ß√£o de formul√°rio, √© necess√°rio usar <code>method="POST"</code>. Formul√°rios com <code>method="GET"</code> (ou sem especificar) simplesmente navegam para a URL indicada, como se fosse um link (<code>&lt;a&gt;</code>), anexando os campos como par√¢metros de consulta, e acionam apenas a fun√ß√£o <code>load</code> da rota de destino ‚Äî nada √© enviado ao objeto <code>actions</code>. Exemplo:</p>

<pre><code class="language-svelte">&lt;form action="/search"&gt;
  &lt;label&gt;
    Pesquisa:
    &lt;input name="q" type="text" /&gt;
  &lt;/label&gt;
  &lt;button&gt;Buscar&lt;/button&gt;
&lt;/form&gt;</code></pre>

<p>Ao submeter, o navegador vai para <code>/search?q=...</code> usando GET e o SvelteKit chama <code>load</code> em <code>/search</code>, mas n√£o aciona nenhuma a√ß√£o de formul√°rio.</p>

<h2 id="Named-actions">A√ß√µes Nomeadas</h2>

<p>Al√©m da a√ß√£o padr√£o, podemos declarar v√°rias a√ß√µes nomeadas em um mesmo arquivo <code>+page.server.js</code>. Cada a√ß√£o √© chamada ao especificar <code>?/nomeDaAcao</code> em <code>action</code> ou em <code>formaction</code>.</p>

<p>Crie o arquivo <code ctc>src/routes/06/named/+page.server.js</code>:</p>
<pre><code class="language-javascript">import { fail } from '@sveltejs/kit';

export const actions = {
    multiplicar: async ({ request }) =&gt; {
        const data = await request.formData();
        const x = Number(data.get('x'));
        const y = Number(data.get('y'));

        if (isNaN(x) || isNaN(y)) return fail(400, { error: 'Informe n√∫meros v√°lidos.', x, y });

        return { result: x * y };
    },
    dividir: async ({ request }) =&gt; {
        const data = await request.formData();
        const x = Number(data.get('x'));
        const y = Number(data.get('y'));

        if (isNaN(x) || isNaN(y)) return fail(400, { error: 'Informe n√∫meros v√°lidos.', x, y });

        if (y == 0) return fail(400, { error: 'N√£o √© poss√≠vel dividir por zero!', x, y });

        return { result: x / y };
    }
};</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Definimos duas a√ß√µes: <code>multiplicar</code> e <code>dividir</code>.</li>
  <li>Linhas 6, 7, 15 e 16: Mesmo que os dados do formul√°rio representem n√∫meros, eles chegam como strings. Por isso, usamos a fun√ß√£o <code>Number</code> para converter essas strings em valores num√©ricos.</li>
  <li>Linhas 9 e 18: Realizamos valida√ß√µes para garantir que os dados convertidos sejam, de fato, n√∫meros. Caso o usu√°rio tenha digitado algo inv√°lido, a fun√ß√£o <code>Number</code> n√£o conseguir√° fazer a convers√£o, e <code>isNaN</code> (de <em>is not a number</em>) retornar√° <code>true</code>, indicando a entrada inv√°lida.</li>
</ul>

<p>Crie o arquivo <code ctc>src/routes/06/named/+page.svelte</code>:</p>
<pre><code class="language-svelte">&lt;script&gt;
  let { form } = $props();
&lt;/script&gt;

&lt;form method="POST" action="?/multiplicar"&gt;
  &lt;label&gt;
    x: &lt;input name="x" type="number" step="0.01" value={form?.x ?? ''} required /&gt;
  &lt;/label&gt;
  &lt;br /&gt;
  &lt;label&gt;
    y: &lt;input name="y" type="number" step="0.01" value={form?.y ?? ''} required /&gt;
  &lt;/label&gt;
  &lt;br /&gt;
  &lt;button type="submit"&gt;Multiplicar&lt;/button&gt;
  &lt;button type="submit" formaction="?/dividir"&gt;Dividir&lt;/button&gt;
&lt;/form&gt;

{#if form &amp;&amp; form.error != undefined}
  &lt;p style="color: red"&gt;{form.error}&lt;/p&gt;
{/if}

{#if form &amp;&amp; form.result != undefined}
  &lt;p style="color: green"&gt;Resultado: {form.result}&lt;/p&gt;
{/if}</code></pre>

<p><strong>Explica√ß√£o:</strong></p>
<ul>
  <li>Linha 5: O formul√°rio padr√£o usa <code>action="?/multiplicar"</code>, acionando a a√ß√£o <code>multiplicar</code>.</li>
  <li>Linha 15: O bot√£o ‚ÄúDividir‚Äù usa <code>formaction="?/dividir"</code>, enviando o mesmo formul√°rio, mas para a a√ß√£o <code>dividir</code>.</li>
  <li>Os valores de <code>form.x</code> e <code>form.y</code> s√£o preservados em caso de erro (para facilitar a corre√ß√£o).</li>
  <li>Linha 18: Se <code>form.error</code> existir, exibimos a mensagem de erro;</li>
  <li>Linha 22: Se <code>form.result</code> existir, exibimos o resultado.</li>
</ul>

<p>Os atributos <code>action</code> e <code>formaction</code> recebem apenas um par√¢metro de consulta como valor (por exemplo, <code>action="?/multiplicar"</code>), o que significa que o formul√°rio ser√° enviado para a mesma rota da URL atual. Caso fosse necess√°rio enviar os dados para uma rota diferente, voc√™ poderia definir, por exemplo, <code>action="/outra/rota?/multiplicar"</code>.</p>

<div class="info">
  <p><strong>Aten√ß√£o:</strong> N√£o √© recomend√°vel combinar a√ß√£o padr√£o com a√ß√µes nomeadas na mesma p√°gina. Se voc√™ submeter uma a√ß√£o nomeada sem redirecionar, o par√¢metro <code>?/acao</code> permanecer√° na URL. Assim, uma pr√≥xima submiss√£o para a a√ß√£o padr√£o continuar√° sendo tratada pela √∫ltima a√ß√£o nomeada, o que pode causar comportamentos inesperados.</p>
</div>

<!--
### üß† **Parte 1 ‚Äî Quest√µes Conceituais**

**1. Explique a diferen√ßa entre uma requisi√ß√£o GET e uma requisi√ß√£o POST em formul√°rios HTML.**

**14. Quando √© mais vantajoso usar `POST` em vez de `GET` em formul√°rios?**

**2. Qual das op√ß√µes abaixo representa um risco de seguran√ßa quando se usa GET para envio de formul√°rios?**
a) Os dados s√£o criptografados automaticamente.
b) Os dados ficam vis√≠veis na URL.
c) O formul√°rio n√£o envia os dados.
d) A requisi√ß√£o GET exige autentica√ß√£o via token.

**3. Complete: Requisi√ß√µes GET n√£o devem causar \_\_\_\_\_\_\_ no servidor, enquanto requisi√ß√µes POST s√£o usadas para \_\_\_\_\_\_\_ .**

**4. O que acontece se voc√™ omitir o atributo `name` de um campo de formul√°rio?**

**15. Qual √© o papel do objeto `event` em uma a√ß√£o de formul√°rio no SvelteKit? Cite ao menos duas propriedades √∫teis.**

**5. Onde os dados retornados por uma a√ß√£o de formul√°rio ficam dispon√≠veis na p√°gina?**

a) `data`
b) `event.params`
c) `form`
d) `load.formData`

**6. Observe este trecho:**

```js
export const actions = {
  default: async ({ request }) => {
    const data = await request.formData();
    const nome = data.get('nome');
    const idade = data.get('idade');
    if (!nome || !idade) return { status: 400 };
    return { status: 200, nome };
  }
};
```

**6a. Quais s√£o os dois campos obrigat√≥rios esperados neste formul√°rio?**
**6b. Qual valor ser√° retornado se o campo "nome" estiver vazio?**
**6c. Onde os dados `status` e `nome` poder√£o ser usados na p√°gina `.svelte` correspondente?**

### üõ†Ô∏è **Parte 3 ‚Äî Pr√°tica Guiada**

**9. Crie um formul√°rio em um arquivo `+page.svelte` que envie via POST um campo chamado `mensagem` para a mesma rota.**

**10. Crie a a√ß√£o default correspondente em `+page.server.js` que retorne o texto da mensagem com status 200, ou status 400 caso o campo esteja vazio.**

**11. Altere o `+page.svelte` para exibir uma mensagem diferente dependendo do status retornado.**

### üß© **Parte 4 ‚Äî Desafio com Redirecionamento de A√ß√£o**

**12. Crie um novo formul√°rio em `src/routes/06/form/+page.svelte` com os seguintes campos:**

* `name="produto"`
* `name="quantidade"`

**O formul√°rio deve ser enviado para a a√ß√£o da rota `/06/post`.**

-->

<h2>Exerc√≠cios</h2>
<ol class="excs">
  <li>Crie a p√°gina <code ctc>src/routes/06/profile/+page.svelte</code>, que <a href="#profile">faltou ser criada</a>, para exibir uma mensagem de boas-vindas.</li>
  <li>post</li>
  <li>envio para outra rota</li>
  <li>redireionamento</li>
  <li>falha</li>
</ol>